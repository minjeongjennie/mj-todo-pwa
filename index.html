<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>날짜별 투두리스트</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 500px; margin: 20px auto; }
  ul { padding-left: 0; }
  li { list-style: none; margin: 8px 0; }
</style>
</head>
<body>

<h2>날짜별 투두리스트</h2>

<label for="datePicker">날짜 선택: </label>
<input type="date" id="datePicker" />

<ul id="todoList"></ul>

<input type="text" id="newTodo" placeholder="새 투두 입력" />
<button id="addBtn">추가</button>

<script>
const datePicker = document.getElementById('datePicker');
const todoList = document.getElementById('todoList');
const newTodo = document.getElementById('newTodo');
const addBtn = document.getElementById('addBtn');

// 오늘 날짜를 기본값으로 세팅
datePicker.value = new Date().toISOString().slice(0,10);

let todos = {};  // { "2025-06-04": [{text:"할일", done:false}, ...] }

// 저장된 데이터 불러오기
function loadTodos() {
  const saved = localStorage.getItem('todos');
  todos = saved ? JSON.parse(saved) : {};
}

// 저장하기
function saveTodos() {
  localStorage.setItem('todos', JSON.stringify(todos));
}

// 현재 선택된 날짜 투두 목록 렌더링
function renderTodos() {
  const date = datePicker.value;
  todoList.innerHTML = '';

  if (!todos[date]) todos[date] = [];

  todos[date].forEach((todo, index) => {
    const li = document.createElement('li');

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.checked = todo.done;
    checkbox.addEventListener('change', () => {
      todos[date][index].done = checkbox.checked;
      saveTodos();
    });

    const span = document.createElement('span');
    span.textContent = todo.text;
    span.style.textDecoration = todo.done ? 'line-through' : 'none';
    checkbox.addEventListener('change', () => {
      span.style.textDecoration = checkbox.checked ? 'line-through' : 'none';
    });

    li.appendChild(checkbox);
    li.appendChild(span);
    todoList.appendChild(li);
  });
}

addBtn.addEventListener('click', () => {
  const text = newTodo.value.trim();
  if (!text) return alert('투두를 입력하세요');

  const date = datePicker.value;
  if (!todos[date]) todos[date] = [];

  todos[date].push({text, done:false});
  newTodo.value = '';
  saveTodos();
  renderTodos();
});

datePicker.addEventListener('change', () => {
  renderTodos();
});

// 초기 실행
loadTodos();
renderTodos();
</script>

</body>
</html>
